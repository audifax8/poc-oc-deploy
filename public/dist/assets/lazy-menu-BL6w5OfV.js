import{R as A,j as e,k as x,L as g,r as p,h as m,l as k,m as I,n as b}from"./index-DV4yV7rO.js";import{O as y,B as P}from"./oswald-DW6juzIP.js";import{A as S}from"./Arrow-DtrsrJEs.js";import{L as C}from"./lato-ClIYKG98.js";import"./vendor-CwAj_GBv.js";const w=A.forwardRef((t,a)=>t.showSkeleton?e.jsx("div",{className:x("yr-skeleton yr-image",t.className)}):e.jsx("img",{ref:a,...t,className:x("yr-image",t.className),loading:t.priority||"lazy"}));w.displayName="Image";function T(t){const{alias:a,icon:l,caName:i}=t.menu,{isOpen:r,onOpenCallback:s}=t,d=o=>{s&&s(o),o.preventDefault(),o.stopPropagation()};return e.jsx(e.Fragment,{children:e.jsxs("summary",{className:"yr-accordion-summary",children:[e.jsx(w,{src:l,alt:a,className:"yr-accordion-summary-image"}),e.jsxs("div",{className:"yr-accordion-header",children:[e.jsx("h3",{className:"yr-accordion-header-title",children:e.jsx(y,{label:i,size:g.md})}),e.jsx("p",{className:"yr-accordion-header-selected",children:e.jsx(C,{label:t.selectedAvName,size:g.md})})]}),e.jsx(P,{icon:e.jsx(S,{size:16,direction:r?"up":"down",className:"yr-accordion-arrow"}),onClick:d})]})})}const E=p.memo(function(t){const{av:a,selectedAvId:l,onClickCallback:i}=t,r=`fc-swatch-wrapper--img ${a.id===l?"fc-swatch-wrapper--img--selected":"fc-swatch-wrapper--img--border"}`,s=p.useCallback((o,c)=>(c.preventDefault(),c.stopPropagation(),i?i(o,c):c),[i]),d=()=>{const o=a;let c=a.url;return o.colorCodeURL&&(c=o.colorCodeURL),c};return e.jsx("button",{type:"button",className:"fc-swatch",onClick:o=>s(a,o),children:e.jsxs("div",{className:"fc-swatch-wrapper",id:a.id.toString(),children:[e.jsx("div",{className:r,children:e.jsx(w,{src:d(),alt:a.name})}),e.jsx("div",{className:"fc-swatch-wrapper--name",children:e.jsx(C,{label:a?.name,size:g.sm})})]})})}),O=t=>{const{remainingItems:a,label:l,onClickCallback:i}=t,r=p.useCallback(s=>(s.preventDefault(),s.stopPropagation(),i?i(s):s),[i]);return e.jsx("button",{type:"button",className:"fc-view-more",onClick:r,children:e.jsxs("div",{className:"fc-view-more--wrapper",children:[e.jsx("div",{className:"fc-view-more--wrapper--amount",children:e.jsx(C,{label:`+ ${a}`,size:g.lg})}),e.jsx("div",{className:"fc-view-more--wrapper--name",children:e.jsx(C,{label:l,size:g.sm})})]})})},R=t=>{const a=new CustomEvent("close:tooltip:other:than",{detail:{id:t}});document.dispatchEvent(a)},L=t=>{const a=new CustomEvent("open:tooltip",{detail:{id:t}});document.dispatchEvent(a),R(t)};let j;const z=({id:t,children:a,content:l,placement:i="top"})=>{const[r,s]=p.useState(!1),d=p.useCallback(c=>{c.detail.id===t&&!r&&(s(!0),j=setTimeout(()=>{s(!1)},3e3))},[r,t]),o=p.useCallback(c=>{c.detail.id!==t&&r&&(s(!1),clearTimeout(j))},[t,r]);return p.useEffect(()=>(document.addEventListener("open:tooltip",d),document.addEventListener("close:tooltip:other:than",o),()=>{document.removeEventListener("open:tooltip",d),document.removeEventListener("close:tooltip:other:than",o)}),[r,t,d,o]),e.jsxs("div",{className:"fc-tooltip",id:`fc-tooltip-${t}`,children:[a,r&&e.jsx("div",{className:x("fc-tooltip-content",`fc-tooltip-content-${i}`),children:l})]})};function B(t){const{alias:a,avs:l,currentPage:i,avsLenght:r}=t.menu,{isOpen:s,selectedAvId:d,onViewMoreClickCB:o,onSwatchClickCB:c}=t,h=n=>{o&&o(n),n.preventDefault(),n.stopPropagation()},f=async(n,u)=>{c&&c(n,u),u.preventDefault(),u.stopPropagation()};return e.jsx(e.Fragment,{children:s&&e.jsx("div",{className:"yr-accordion-content",children:e.jsxs("ul",{className:"fc-attribute-values","aria-label":"attribute values menu",children:[l&&l?.length&&l.map((n,u)=>e.jsx("li",{children:e.jsx(z,{id:n.id,content:`Error selecting ${n.name}. Please try again.`,children:e.jsx(E,{av:n,caAlias:a,selectedAvId:d,index:u,onClickCallback:f})},n.id)},n.id||u)),i<r&&e.jsx("li",{children:e.jsx(O,{remainingItems:r-i,label:"view more",onClickCallback:h})},l?.length)]})})})}async function D(t,a,l){return new Promise(i=>{const r=m.luxAPI.getAttributeByAlias(t);m.configureCore.setRecipe([{ca:{alias:t},av:{id:a}}]).then(async()=>{const s=m.luxAPI?.getToken(),d=await m.rtrAPI?.isInitialized(),o=await m.rtrAPI?.isIdAvailable(s);if(d&&!o)throw Error("Invalid token");const c=r?.viewName,h=m.luxAPI.getProductImg(c),f=m.luxAPI.mapConfigureImgs(c),n=m.rtrAPI.mapCameraNameRTRToComponent(t);return k({token:s,configureImg:h,imgs:f,viewName:c}),m.rtrAPI?.selectComponent(n),m.rtrAPI?.handleTokenChange(s),m?.assetsWorker?.preloadAssets(t),i(!0)}).catch(async()=>(L(a),await m.configureCore?.setRecipe([{ca:{alias:t},av:{id:l}}]),i(!1)))})}function M(t){const{alias:a}=t.menu,[l,i]=p.useState(t.menu.selectedAvId),[r,s]=p.useState(t.menu.selectedAvName),[d,o]=p.useState(!1),c=n=>{o(!d);const u=m.luxAPI?.getAttributeByAlias(a),v=m.rtrAPI?.mapCameraNameRTRToComponent(a),N=u?.viewName;k({viewName:N}),m.rtrAPI?.selectComponent(v),m?.assetsWorker?.preloadAssets(a),n.preventDefault(),n.stopPropagation()},h=()=>{const n=m.luxAPI?.reloadPagination(t.menu);return I(n)},f=async(n,u)=>(u.preventDefault(),u.stopPropagation(),D(a,n.id,l).then(v=>{v&&(i(n.id),s(n.name))}));return e.jsx("details",{open:d,className:"yr-accordion",onClick:c,children:e.jsxs(e.Fragment,{children:[e.jsx(T,{menu:t.menu,selectedAvId:l,selectedAvName:r,isOpen:d,onOpenCallback:c}),e.jsx(B,{menu:t.menu,isOpen:d,selectedAvId:l,selectedAvName:r,onViewMoreClickCB:h,onSwatchClickCB:f})]})})}function W(){const[t]=b();return e.jsx(e.Fragment,{children:t?.map(a=>e.jsx(M,{menu:a},a.id))})}export{W as default};
